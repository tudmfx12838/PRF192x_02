<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>

    <title>asm2</title>
<style>

th,td{
    border: 2px solid black;
}

</style>

</head>
<body>

    <div class="container-fluid text-center" id="inputForm">
        <h1 class="bg-primary text-white rounded">Class Marksheet</h1>
        <label for="name" class ="col-6 col-sm-2">Họ Tên: </label><input class ="col-6 col-sm-3" id="name" type="text"><br>
        <label for="math" class ="col-6 col-sm-2">Điểm Toán: </label><input class ="col-6 col-sm-3" id="math" type="number"><br>
        <label for="physical" class ="col-6 col-sm-2">Điểm Lý: </label><input class ="col-6 col-sm-3" id="physical" type="number"><br>
        <label for="chemistry" class ="col-6 col-sm-2">Điểm Hóa: </label><input class ="col-6 col-sm-3" id="chemistry" type="number"><br><br>
        <input type="button" class="btn btn-secondary" value="Nhập" onclick="inputValue()">
    </div>
    <br>

    <div class="container-fluid text-center">
        <table id="table" class="container text-center table-responsive-sm">
            <tr>
                <th class ="col-1 col-sm-1">STT</th>
                <th class ="col-3 col-sm-3">Họ tên</th>
                <th class ="col-2 col-sm-2">Toán</th>
                <th class ="col-2 col-sm-2">Lý</th>
                <th class ="col-2 col-sm-2">Hóa</th>
                <th class ="col-2 col-sm-2">Trung Bình</th>
            </tr>
        </table>
        <br>
        <input type="button" class="btn btn-secondary col-12 col-sm-4 col-md-3" value="Tính điểm trung bình" onclick="calculateAverageScore(testScore,counterSTT)">
        <input type="button" class="btn btn-success col-12 col-sm-4 col-md-3" value="Xác định học sinh giỏi" onclick="identifyGoodStudent(testScore,counterSTT)">
    </div>
    <br>
    <div class="container-fluid text-center">
        <label for="deleteSTT">Nhập STT cần xóa: </label>
        <input type="number" id="deleteSTT">
        <input type="button" class="btn btn-danger" value="Xóa" onclick="deleteSTT(testScore)">
    </div>
    
    <br>
    <p id="demo"></p>

    <script>
        
        /**
        * @description An object testScore to store student's namme and score
        * @Consist of 5 array as name, math, physical, chemistry, diemTB
        */
        var testScore = { 
                        name: [],
                        math: [],
                        physical: [],
                       chemistry: [],
                       diemTB:[]
        };

        /**
        * @description a counter variable
        * @will  be increated to 1 when input a student's information
        * @will  be decreated to 1 when delete a student's information
        * */
        var counterSTT=0;

        /**
        * @description call inputValue() to get value from input and upadate to object testScore when button as Nhập is clicked.
        */
        function inputValue(){
            var name = document.getElementById("name");
            var math = document.getElementById("math");
            var physical = document.getElementById("physical");
            var chemistry = document.getElementById("chemistry");

            //if input's text is blank, aleart request full input
            if((name.value=="")||(math.value=="")||(physical.value=="")||(chemistry.value=="")){
                    alert("Hãy nhập đầy đủ thông tin Họ Tên, Điểm Toán, Điểm Lý, Điểm Hóa");
               
            }
            else{
                
                pushValue(testScore); //Call method pushValue() to update value to object testScore
                updateTable(testScore, counterSTT); //Call method updateTable() to update value form object testScore to table

                //TODO: increase to 1 when input a student's information done
                counterSTT++;     
            }
        }

        /**
        * @description update value to object testScore.
        * @param object testScore
        */
        function pushValue(obj){
            obj.name.push(document.getElementById("name").value);
            obj.math.push(parseFloat(document.getElementById("math").value));
            obj.physical.push(parseFloat(document.getElementById("physical").value));
            obj.chemistry.push(parseFloat(document.getElementById("chemistry").value)); 

            //TODO: Remove value after inputting
            document.getElementById("name").value = "";
            document.getElementById("math").value = "";
            document.getElementById("physical").value = "";
            document.getElementById("chemistry").value = "";   

        }

        /**
        * @description update value form object testScore to table
        * @param object testScore
        */
        function updateTable(obj,counter){
            var table = document.getElementById("table");
            /*table.innerHTML += "<tr><td>"
                + (counter+1) +"</td><td>"
                + obj.name[counter]+"</td><td>"
                + obj.math[counter]+"</td><td>"
                + obj.physical[counter]+"</td><td>"
                + obj.chemistry[counter]+"</td><td>"
                + "?" + "</td></tr>";*/

            var row = table.insertRow(counter+1);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
            var cell6 = row.insertCell(5);
            cell1.innerHTML = counter + 1;
            cell2.innerHTML = obj.name[counter];
            cell3.innerHTML = obj.math[counter];
            cell4.innerHTML = obj.physical[counter];
            cell5.innerHTML = obj.chemistry[counter];
            cell6.innerHTML = "?";
        }

        /**
        * @description calculate student's average Score when button as "Tính điểm trung bình" is clicked
        * @param object testScore
        * @param counter
        */
        function calculateAverageScore(obj, index){
            var table = document.getElementById("table");
            
            //counter is zero that's mean table blank 
            if(index==0){
               alert("Chưa có dữ liệu học để tính điểm. Hãy nhập đầy đủ thông tin học sinh"); 
               //alert request input student's infomation
            }
            else{
                for(let i = 0; i < index; i++){
                    obj.diemTB[i] = (obj.math[i] + obj.physical[i] + obj.chemistry[i])/3;
                    obj.diemTB[i] = obj.diemTB[i].toFixed(2);
                }
            }
           
            //update average Score to table
            for(let i = 0; i <index; i++){
                var x = document.getElementById("table").rows[i+1].cells;
                x[5].innerHTML =  obj.diemTB[i];
            }
        }


        /**
        * @description calculate student's average Score when button as "Xác định học sinh giỏi" is clicked
        * @param object testScore
        * @param counter
        */
        function identifyGoodStudent(obj, index){
            
            //counter is zero that's mean table blank 
            if(index==0){
               alert("Chưa có dữ liệu học để xác định học sinh giỏi. Hãy nhập đầy đủ thông tin học sinh");
               //alert request input student's infomation
            }
            else{
                //identify good student with average score is greater than 8.5 and bold red color
                for(let i = 0; i < index; i++){
                    if(parseFloat(obj.diemTB[i]) >= 8.0){
                        var x = document.getElementById("table").rows[i+1].style.color ="red";
                    }
                }
            }
        }

        /**
        * @description delete student's information following STT when button as "Xóa" is clicked
        * @param object testScore
        */
        function deleteSTT(obj){           
            var stt = parseInt(document.getElementById("deleteSTT").value);

            //counter is zero that's mean table blank 
            if(counterSTT==0){
                alert("Danh sách học sinh trống");//alert table is blank                
                document.getElementById("deleteSTT").value ="";
            }
            else{
                //if stt is NaN alert request input stt need to detele
                if(stt){
                    //TODO: delete student's information following inputed stt want to delete
                    obj.name.splice(stt-1,1);
                    obj.math.splice(stt-1,1);
                    obj.physical.splice(stt-1,1);
                    obj.chemistry.splice(stt-1,1);
                    obj.diemTB.splice(stt-1,1);
                    
                    //TODO decrease counter to 1 when delete a student's information
                    counterSTT--;

                    //Call method updateTableAfterDelete() Update table after detele a student's information
                    updateTableAfterDelete(stt,counterSTT);
                }
                else{
                    alert("Nhập STT học sinh cần xóa");
                }
            }
        }

        /**
        * @description Update table after detele a student's information
        * @param stt
        * @param counter
        */
        function updateTableAfterDelete(stt,index){
            var table = document.getElementById("table");
            table.deleteRow(stt);

            for(let i = 0; i <index; i++){
                var x = document.getElementById("table").rows[i+1].cells;
                x[0].innerHTML =  i+1;
            }

            document.getElementById("deleteSTT").value ="";
        }
       

    </script>

</body>
</html>